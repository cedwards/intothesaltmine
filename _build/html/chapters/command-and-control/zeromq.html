

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ZeroMQ &mdash; Into The Salt Mine</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
        <link rel="copyright" title="Copyright" href="../../copyright.html"/>
    <link rel="top" title="Into The Salt Mine" href="../../index.html"/>
        <link rel="up" title="Command &amp; Control" href="index.html"/>
        <link rel="next" title="Key Management" href="key-management.html"/>
        <link rel="prev" title="Command &amp; Control" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="fa fa-home"> Into The Salt Mine</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface/index.html">Preface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../preface/who-should-read-this-book.html">Who Should Read This Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/why-i-wrote-this-book.html">Why I Wrote This Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/navigating-this-book.html">Navigating This Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/online-resources.html">Online Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/conventions-used-in-this-book.html">Conventions Used In This Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/using-code-examples.html">Using Code Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/how-to-contact-me.html">How To Contact Me</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface/introduction.html">Introduction</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Chapters</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Command &amp; Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../events-and-reactions/index.html">Events &amp; Reactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../job-management/index.html">Job Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../web-interface-and-API/index.html">Web Interface &amp; API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling-tasks/index.html">Scheduling Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../provisioning/index.html">Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../salt-at-scale/index.html">Salt at Scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration-options/index.html">Configuration Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about-the-author.html">About The Author</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Into The Salt Mine</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Chapters</a> &raquo;</li>
      
          <li><a href="index.html">Command &amp; Control</a> &raquo;</li>
      
    <li>ZeroMQ</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="zeromq">
<h1>ZeroMQ<a class="headerlink" href="#zeromq" title="Permalink to this headline">¶</a></h1>
<p>I&#8217;d be remiss in my duties as an author if I did not start a book about
SaltStack by discussing ZeroMQ. This, I think, is the fundamental cornerstone
of what makes SaltStack so powerful. Without ZeroMQ SaltStack would not be
capable of what it does, and many of the performance-specific benefits would be
gone. In order to share with you the big picture vision of what SaltStack is
capable of, we&#8217;ll first need to talk a little bit about ZeroMQ.</p>
<div class="section" id="what-is-zeromq">
<h2>What is ZeroMQ?<a class="headerlink" href="#what-is-zeromq" title="Permalink to this headline">¶</a></h2>
<p>What is ZeroMQ and why should I care? Let&#8217;s just dive right in. First, ZeroMQ
is a socket-based high speed networking library that is leveraged by SaltStack
to allow for real-time communication between systems. SaltStack leverages
ZeroMQ to perform the high-speed communication between systems, while not
requiring a managed service to be running.</p>
<p>Technically ZeroMQ is a message queue, similar to those that you might be
familiar with. AMQP, rabbitmq, kafka, etc. These are all popular message queue
services that you can set up in your infrastructure. The primary difference
here is that ZeroMQ is not another service to setup and maintain. It is simply
a programming library that application developers can leverage in order to
achieve high speed network communication within their application. SaltStack&#8217;s
requirement on ZeroMQ requires no effort or configuration on your behalf, but
provides all the benefits of a full-fledged messaging service.</p>
<p>So why ZeroMQ? ZeroMQ was developed initially for high-speed banking
transactions. A large banking institution determined that the network
transactions themselves were too expensive, costing the company millions of
dollars. They specifically set out to design a message queue interface that
would allow for high speed, low cost transactions on the network, saving them
money.</p>
<p>We&#8217;re all familiar with the word &#8216;latency&#8217;. We generally understand that the
lower the latency the better. This was essentially the goal here. Achieve the
lowest latency possible, in the simplest manner possible. The people behind
ZeroMQ initially created the AMQP system. This was designed for JP Morgan
Chase, specific to their network latency needs. AMQP has since been abandoned
by the initial developers (although still maintained by adopters), in
preference of what they suggest is an improved system with ZeroMQ.</p>
</div>
<div class="section" id="zeromq-and-salt">
<h2>ZeroMQ and Salt<a class="headerlink" href="#zeromq-and-salt" title="Permalink to this headline">¶</a></h2>
<p>How does Salt leverage ZeroMQ? To be honest it&#8217;s all pretty transparent to the
end user. You could never learn anything more about ZeroMQ than what is
included here and still use SaltStack in an enterprise setting. While it is a
very critical and important piece, the way that it has been implemented is very
transparent to the user. All you have to worry about is starting the
<tt class="docutils literal"><span class="pre">salt-master</span></tt> and <tt class="docutils literal"><span class="pre">salt-minion</span></tt> services (which we&#8217;ll cover later), and the
ZeroMQ based network layer is automatically maintained. I think this fact is
both a credit to the ZeroMQ developers as well as the SaltStack developers.
Such an integral component is as transparent and maintenance-free as it is.</p>
<p>The reason that I wanted to cover ZeroMQ first is because it is a key reason
why SaltStack is different than any of its competitors. It is what sets it
apart from other remote execution and configuration management tools. Many of
these other tools leverage existing communication protocols, such as <tt class="docutils literal"><span class="pre">ssh</span></tt> or
a traditional serial <tt class="docutils literal"><span class="pre">TCP</span></tt> socket connection. While these solutions excel in
some areas, they simply weren&#8217;t designed for the scale at which SaltStack
operates.</p>
<p>Let me see if I can describe this in a simple way.</p>
<p>SaltStack excels at high-speed, asynchronous communication between connected
systems. This communication&#8211;this underlying message bus&#8211;can be leveraged for
many different uses, only one of which is parallel remote execution. Let&#8217;s
imagine for a moment how this all fits together.</p>
<p>Imagine your infrastructure the way it stands today. Dozens, hundreds or
thousands of servers tucked away nicely in data centers around the world. These
systems are connected to power and networked via switches and routers. it isn&#8217;t
terribly complicated if you think about it. You can currently connect to any of
your systems from your management network and do any amount of administration
needed. That administration is generally done over <tt class="docutils literal"><span class="pre">ssh</span></tt>, which is usually a
one-to-one connection. You connect securely to one system, do your maintenance,
and move on to the next. That&#8217;s the way it&#8217;s been done for years. That&#8217;s the
way it&#8217;s been done for as long as I can remember anyway.</p>
<p>Granted there are some tools that expand this functionality a bit. Tools like
<tt class="docutils literal"><span class="pre">clusterssh</span></tt> allow you to mirror commands to multiple systems at once over
multiple <tt class="docutils literal"><span class="pre">ssh</span></tt> connections. This works well to an extent, but there is a
point at which this method doesn&#8217;t scale. Unfortunately there are simply not a
lot of tools that allow you to control large pieces of your infrastructure in a
timely manner.</p>
<p>Now imagine that all of your systems were connected over a high speed,
asynchronous messaging system. Imagine being able to send commands to one
system or a thousand systems using the same method. Imagine being able to
leverage this high speed message bus to query real-time information about all
of your systems, all at once. This is what ZeroMQ provides for us in the
SaltStack world. A high-speed way to connect to not one-at-a-time, not
two-at-a-time but all-at-a-time with little overhead.</p>
<p>Just imagine for a second a high-speed network connecting all of your systems.
A network that is fully encrypted and sits on top of your existing physical
network infrastructure. This network can easily connect hundreds, thousands and
even tens of thousands of systems without issue.This network can provide you
with a low latency method by which you can query for or send information to
your entire network of servers.  I really hope you&#8217;re paying attention here,
because this is the foundational piece of the entire Salt stack. This is the
piece that allows the rest of the magic to happen. This is the piece that
facilitates the high speed communication between systems, and not just minion
and master. This high speed network can be leveraged for one minion to query or
communicate with another minion. While it is traditionally a pub-sub
communication pattern it can be thought of more broadly in the sense that it
allows near instant communication between your entire infrastructure.</p>
<p>I want to again reiterate that this high speed network requires no additional
services to install and maintain, and little to know knowledge of the
underlying connectivity to use. It is truly high speed, low latency
connectivity at low cost. Low cost to the network and low cost to the
maintainers of the infrastructure. It is all behind the scenes. The magic
behind the curtain.</p>
<p>As you get deeper into this book I want you to keep in mind that everything
rides on top of this high speed encrypted network. Every command you post to
the message queue is instantly available to all of your systems. Every time you
want to update configuration on your servers the instructions are instantly
available everywhere. No more iterating through lists and sending commands over
ssh. No more sitting and waiting for networking protocols that weren&#8217;t designed
for the scale of todays internet try and keep up. You will be leveraging a
modern, encrypted, asynchronous communication network actually designed just
for this.The Internet is growing. Your company is growing. Grow with it.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="key-management.html" class="btn btn-neutral float-right" title="Key Management"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Command &amp; Control"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../../copyright.html">Copyright</a> 2014, Christer Edwards.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2014.12.11',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>